<div class="page">
  <header class="page-header">
    <h1 class="page-header-title">Precios</h1>
    <p class="page-header-subtitle">
      Configura la estrategia global de precios y visualiza los productos.
    </p>
  </header>

  <section class="card">
    <header class="card-header">
      <h2 class="card-title">Configuración global</h2>
    </header>

    <form class="form-grid" (ngSubmit)="saveConfig()" #pricingForm="ngForm">
      <div class="form-field">
        <label for="strategy">Estrategia por defecto</label>
        <select
          id="strategy"
          name="selectedStrategy"
          [(ngModel)]="selectedStrategy"
        >
          <option [ngValue]="PriceStrategyType.Standard">Standard</option>
          <option [ngValue]="PriceStrategyType.Discount">Descuento</option>
          <option [ngValue]="PriceStrategyType.Dynamic">Dinámica</option>
        </select>
      </div>

      <div class="form-field">
        <label for="discount">Descuento por defecto (%)</label>
        <input
          id="discount"
          type="number"
          name="defaultDiscount"
          [(ngModel)]="defaultDiscount"
        />
      </div>

      <div class="form-field">
        <label for="demand">Factor de demanda</label>
        <input
          id="demand"
          type="number"
          step="0.1"
          name="defaultDemand"
          [(ngModel)]="defaultDemand"
        />
      </div>

      <div class="form-field" style="align-self: end">
        <button class="btn btn-primary" type="submit">
          Guardar configuración
        </button>
      </div>
    </form>

    <p *ngIf="config" class="kpi-trend">
      Actual: {{ config.defaultStrategy }} |
      Desc: {{ config.defaultDiscountPercentage ?? '-' }} |
      Demanda: {{ config.defaultDemandFactor ?? '-' }}
    </p>

    <p *ngIf="message" class="alert alert-info">
      {{ message }}
    </p>
  </section>

  <section class="card" style="margin-top: 1.25rem">
    <header class="card-header">
      <h2 class="card-title">Productos</h2>
    </header>

    <div class="table-wrapper">
      <table class="table">
        <thead>
          <tr>
            <th>Id</th>
            <th>Nombre</th>
            <th>Precio base</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of products">
            <td>{{ p.id }}</td>
            <td>{{ p.name }}</td>
            <td>{{ p.basePrice | currency: 'PEN':'symbol':'1.2-2' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>
</div>
